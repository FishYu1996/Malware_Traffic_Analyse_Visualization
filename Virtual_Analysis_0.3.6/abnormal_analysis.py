# coding=UTF-8
import LSTM_dga
import db_helper

def get_domain_IP():
    sql = "select Domain,IP_address from dns_part_data where Direction = 'Response'"
    results = db_helper.get_data(sql)
    domain_list = []
    IP_list = []
    for result in results:
        domain_list.append(result[0].split(".")[0])
        IP_list.append(result[1])
    return domain_list,IP_list

def predict_dga_ip():
    domain_list, Ip_list = get_domain_IP()
    abnormal_domain = LSTM_dga.predict_dga(domain_list)
    abnormal_IP_list = []
    for domain in abnormal_domain:
        index = domain_list.index(domain)
        abnormal_IP_list.append(Ip_list[index])
    return abnormal_IP_list, abnormal_domain