package TestJpcap;
import java.awt.Font;
import java.text.SimpleDateFormat;
import java.util.Iterator;
import java.util.Map;

import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartFrame;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.axis.Axis;
import org.jfree.chart.axis.CategoryAxis;
import org.jfree.chart.axis.CategoryLabelPositions;
import org.jfree.chart.axis.DateAxis;
import org.jfree.chart.axis.NumberAxis;
import org.jfree.chart.axis.NumberTickUnit;
import org.jfree.chart.axis.ValueAxis;
import org.jfree.chart.plot.CategoryPlot;
import org.jfree.chart.plot.PlotOrientation;
import org.jfree.chart.plot.XYPlot;
import org.jfree.data.category.CategoryDataset;
import org.jfree.data.category.DefaultCategoryDataset;
import org.jfree.data.time.Month;
import org.jfree.data.time.RegularTimePeriod;
import org.jfree.data.time.Second;
import org.jfree.data.time.TimeSeries;
import org.jfree.data.time.TimeSeriesCollection;
import org.jfree.data.xy.XYDataset;
import org.jfree.data.xy.XYSeries;
import org.jfree.data.xy.XYSeriesCollection;

public class TimeSeriesChart {
  
  public static CategoryDataset createDataSet(String title,Map<Long,Integer> data) {  
	  
    XYSeriesCollection seriesCollection = new XYSeriesCollection();  
    XYSeries series1 = new XYSeries(title);  
    DefaultCategoryDataset series2=new DefaultCategoryDataset();
    Iterator it = data.keySet().iterator();
    while (it.hasNext()) {
      long pre_x=(long)it.next();
      String x=Tools.stampToDate(pre_x);
      int y=data.get(pre_x);
      series1.add(pre_x,y);
      series2.addValue(y,"1",x);
    } 
        seriesCollection.addSeries(series1);  
        
        return series2;  
    }  
  
 public static void createLineChart(String title,String x,String y,Map<Long,Integer> data) {  
    	
        JFreeChart chart = ChartFactory.createLineChart(title,           //图表标题
        				x,                           //X轴标题
        				y,                           //Y轴标题
        				createDataSet(title,data),     //绘图数据集
        				PlotOrientation.VERTICAL,    //绘制方向
        				true,                        //显示图例
        				true,                        //采用标准生成器
        				false);                      //是否生成超链接

        ChartFrame frame=new ChartFrame(title,chart); 
        //设置标题字体
    	chart.getTitle().setFont(new Font("宋体", Font.BOLD, 15));
    	chart.getLegend().setItemFont(new Font("黑体", Font.BOLD, 15)); // 设置图例类别字体
    	//获取图表区域对象
    	CategoryPlot plot = (CategoryPlot) chart.getPlot();
        CategoryAxis rangeaxis= ( CategoryAxis)plot.getDomainAxis();
    	rangeaxis.setCategoryLabelPositions(CategoryLabelPositions.DOWN_45);
    	rangeaxis.setTickLabelFont(new Font("宋体",Font.BOLD,10));
    	NumberAxis numberaxis = (NumberAxis) plot.getRangeAxis();   
    	/*------设置Y轴坐标上的文字-----------*/ 
    	numberaxis.setTickLabelFont(new Font("黑体", Font.PLAIN, 12));    
    	/*------设置Y轴的标题文字------------*/ 
    	numberaxis.setLabelFont(new Font("宋体", Font.PLAIN, 12));
    	frame.setBounds(50, 50, 800, 600);
    	frame.setVisible(true);
  }  
 
}
